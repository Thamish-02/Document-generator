## AI Summary

A file named ipython_directive.py.


### Function: block_parser(part, rgxin, rgxout, fmtin, fmtout)

**Description:** part is a string of ipython text, comprised of at most one
input, one output, comments, and blank lines.  The block parser
parses the text into a list of::

  blocks = [ (TOKEN0, data0), (TOKEN1, data1), ...]

where TOKEN is one of [COMMENT | INPUT | OUTPUT ] and
data is, depending on the type of token::

  COMMENT : the comment string

  INPUT: the (DECORATOR, INPUT_LINE, REST) where
     DECORATOR: the input decorator (or None)
     INPUT_LINE: the input as string (possibly multi-line)
     REST : any stdout generated by the input line (not OUTPUT)

  OUTPUT: the output string, possibly multi-line

## Class: EmbeddedSphinxShell

**Description:** An embedded IPython instance to run inside Sphinx

## Class: IPythonDirective

### Function: setup(app)

### Function: test()

### Function: __init__(self, exec_lines)

### Function: cleanup(self)

### Function: clear_cout(self)

### Function: process_input_line(self, line, store_history)

### Function: process_input_lines(self, lines, store_history)

**Description:** process the input, capturing stdout

### Function: process_image(self, decorator)

**Description:** # build out an image directive like
# .. image:: somefile.png
#    :width 4in
#
# from an input like
# savefig somefile.png width=4in

### Function: process_input(self, data, input_prompt, lineno)

**Description:** Process data block for INPUT token.

### Function: process_output(self, data, output_prompt, input_lines, output, is_doctest, decorator, image_file)

**Description:** Process data block for OUTPUT token.

### Function: process_comment(self, data)

**Description:** Process data fPblock for COMMENT token.

### Function: save_image(self, image_file)

**Description:** Saves the image file to disk.

### Function: process_block(self, block)

**Description:** process block from the block_parser and return a list of processed lines

### Function: ensure_pyplot(self)

**Description:** Ensures that pyplot has been imported into the embedded IPython shell.

Also, makes sure to set the backend appropriately if not set already.

### Function: process_pure_python(self, content)

**Description:** content is a list of strings. it is unedited directive content

This runs it line by line in the InteractiveShell, prepends
prompts as needed capturing stderr and stdout, then returns
the content as a list as if it were ipython code

### Function: custom_doctest(self, decorator, input_lines, found, submitted)

**Description:** Perform a specialized doctest.

### Function: get_config_options(self)

### Function: setup(self)

### Function: teardown(self)

### Function: run(self)
